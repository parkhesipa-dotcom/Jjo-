from flask import request
from flask_restful import Resource
from pydantic import ValidationError
from models.lrs_model import LRSRequest
from services.lrs_service import fetch_lrs_data


class LRSVerification(Resource):
    def post(self):
        try:
            data = request.get_json()
            validated = LRSRequest(**data)

            result = fetch_lrs_data(validated.pan, validated.uniqueId)
            return result, 200

        except ValidationError as e:
            return {"error": e.errors()}, 400
        except Exception as e:
            return {"error": str(e)}, 500
